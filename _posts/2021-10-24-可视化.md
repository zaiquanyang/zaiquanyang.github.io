---
<!-- layout: post -->
title: 可视化方法
tags: code
---

### 1. TSNE 可视化
```python
# 3D / 2D可视化
def TSNE_API(data, label):
    """

    :param data: numpy array N x dim
    :param label: N
    :return:
    """
    print('data shape: {}, label shape: {}'.format(data.shape, label.shape))

    tsne = TSNE(n_components=2, init='random', random_state=100, perplexity=40, n_iter=1000)
    # data
    # normalize data
    # data_norm = F.normalize(data, p=2, dim=-1)
    data = tsne.fit_transform(data)

    x_min, x_max = np.min(data, 0), np.max(data, 0)
    data_norm = (data - x_min) / (x_max - x_min)

    # 指定要可视化的类别数目 N 和列表 plot_class_list
    # N = 20
    # unique_cls = np.unique(label)[:N].tolist()     # 只绘制前十个类别
    # plot_class_list = unique_cls
    plot_class_list = [ 79, 86, 87, 91]  # 71， 90
    N = len(plot_class_list)

    cls_num = len(plot_class_list)
    color_list = ["#000000", "#B22222", "#9400D3", "#FFA500"] # "#000000", "#8B0000",         # get_color_list(num=cls_num)

    fig = plt.figure(dpi=600)
    # ax = plt.subplot()
    ax = Axes3D(fig)

    flag = [0] * N

    for i in range(data_norm.shape[0]):
        ss = 10
        marker = 'o'
        alpha = 0.6
        if label[i] in plot_class_list:
            index = plot_class_list.index(label[i])
            ax.scatter(data_norm[i, 0], data_norm[i, 1], 0, s=10, c=color_list[index], alpha=alpha, marker=marker, label=label[i])
            if flag[index] == 0:
                ax.text(data_norm[i, 0], data_norm[i, 1], 0, str(label[i]), fontdict={'weight': 'bold', 'size': 10}, color="#000000")
                # plt.text(data_norm[i, 0], data_norm[i, 1], data_norm[i, 2], 60, str(label[i]), size=10, alpha=0.8, weight="bold", color="#000000")
                flag[index] = 1

    # plt.legend()
    ax.set_xlabel('X label')
    ax.set_ylabel('Y label')
    # ax.set_zlabel('Z label')
    # plt.axis('off')

    # bbox_inches='tight',  pad_inches=0 去除图像空白
    # plt.savefig('/data/code/C2F_ZSL/visualize/awa2_tsne_10_class_mix.png', dpi=1000, bbox_inches='tight', pad_inches=0)
    plt.show()

    return fig
```
